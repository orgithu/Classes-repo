<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <title>Лабораторийн ажил 8 - Нэг хуудаст вэб сайт</title>
</head>
<body>
    <h1>Лабораторийн ажил 8</h1>

    <h2>1. Асинхрон AJAX POST</h2>
    <button onclick="loadPagePost()">POST to get page1</button>
    <div id="postContent"></div>

    <h2>2. Синхрон AJAX GET</h2>
    <button onclick="loadPageGetSync()">GET page2</button>
    <div id="getContent"></div>

    <h2>3. Асинхрон AJAX GET</h2>
    <button onclick="loadStudents()">GET student info</button>
    <table id="studentsTable">
        <thead>
            <tr>
                <th>Овог</th>
                <th>Нэр</th>
                <th>Оюутны код</th>
                <th>Нас</th>
                <th>Төрсөн огноо</th>
                <th>number</th>
                <th>Голч дүн</th>
                <th>Чөлөө авсан эсэх</th>
            </tr>
        </thead>
        <tbody id="studentsBody">
        </tbody>
    </table>

    <script>
        // 1. Асинхрон AJAX POST
        function loadPagePost() {
            const xhr = new XMLHttpRequest();
            xhr.open('POST', '/page1', true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    document.getElementById('postContent').innerHTML = xhr.responseText;
                }
            };
            xhr.send('data=sample');
        }

        // 2. Синхрон AJAX GET
        function loadPageGetSync() {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', '/page2', false); // Синхрон
            xhr.send();
            if (xhr.status === 200) {
                document.getElementById('getContent').innerHTML = xhr.responseText;
            }
        }

        // 3. Асинхрон AJAX GET JSON
        function loadStudents() {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', '/students', true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    const students = JSON.parse(xhr.responseText);
                    displayStudents(students);
                }
            };
            xhr.send();
        }

        function displayStudents(students) {
            const tbody = document.getElementById('studentsBody');
            tbody.innerHTML = '';
            students.forEach(student => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.surname}</td>
                    <td>${student.name}</td>
                    <td>${student.studentCode}</td>
                    <td>${student.age}</td>
                    <td>${student.birthDate}</td>
                    <td>${student.id}</td>
                    <td>${student.gpa}</td>
                    <td>${student.onLeave ? 'Тийм' : 'Үгүй'}</td>
                `;
                tbody.appendChild(row);
            });
        }
    </script>
</body>
</html>
